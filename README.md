# 项目背景
由于公司的excel生成过于缓慢，有时生成一个excel文件需要等待几十秒甚至几分钟，在等待的时候用户不能跳转其他页面，用户体验不好，可以先看一下，公司excel的下载流程图

https://img-blog.csdnimg.cn/2bf8dfd3bc32471f901d7dcfdb094923.png

可以发现问题所在，在查询数据的时候可能会有比较长的时间等待以及excel的生成都需要一定的时间，且数据结构单一，对不同的表单和报表等都需要独立出代码，代码的复用不高，所以进行如下优化。

先看优化后的流程图：
https://img-blog.csdnimg.cn/98f11c1b040c48d1972e8e04189f757f.png


需求：用户选择需要下载的excel数据，会把选择的数据id发送给后台，后台有个解析数据的服务会把请求下载的数据，转化为sql，发送给异步下载excel，excel接收到sql并加入到线程池，返回通知给前端，正在下载的信息，用户便可在下载任务查看下载情况，在重新点击下载。下面便会分享的是异步下载excel的具体过程，至于服务转发就不在这里阐述了


# 涉及技术
SpringBoot、MyBatis、MyBatisPlus、EasyExcel、线程池、单例模式
